<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="articleapp.Pages.MainArticlePage"
             xmlns:local="clr-namespace:articleapp.ViewModels"
         >

    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#0a0426" Offset="0.5" />
            <GradientStop Color="#000000" Offset="0.0" />
            <GradientStop Color="#1a0b2e" Offset="1.0" />
        </LinearGradientBrush>
    </ContentPage.Background>



    <ScrollView>
        <Grid RowSpacing="25" Padding="24,40">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title and Search Bar -->

            <Grid Grid.Row="0" RowSpacing="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <Label Text="Discover Articles"
           TextColor="White"
           FontSize="32"
           FontFamily="Jersey15"
           Margin="0,0,0,10" />

                <Frame Grid.Row="1"
           BackgroundColor="black"
           Padding="20,5"
           CornerRadius="30"
           BorderColor="#1E293B"
           HasShadow="True">
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="15">
                        <Image Grid.Column="0"
                   Source="search.png"
                   HeightRequest="24"
                   WidthRequest="24"
                   Opacity="0.6" />

                        <Entry Grid.Column="1"
                   Placeholder="Search for topics, authors"
                   PlaceholderColor="#64748B"
                   TextColor="White"
                   BackgroundColor="Transparent"
                   FontFamily="Jersey15"
                   FontSize="16"
                   VerticalOptions="Center"
                   Focused="OnEntryFocused" />

                        <Button Grid.Column="2"
                    ImageSource="filter.png"
                    BackgroundColor="#1E293B"
                    HeightRequest="40"
                    WidthRequest="40"
                    CornerRadius="20"
                    Padding="0" />
                    </Grid>
                </Frame>
            </Grid>


            <ScrollView Grid.Row="1" 
            Orientation="Horizontal" 
            HorizontalScrollBarVisibility="Never">
                <CollectionView ItemsSource="{Binding Categories}"
                    ItemsLayout="HorizontalList">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Grid.Column="2"
BackgroundColor="Transparent"
                           BorderColor="Transparent"
Padding="12,6"
CornerRadius="20"
HasShadow="False">
                                <Label Text="{Binding CategoryName}"
    TextColor="AliceBlue"
    FontSize="16"
                               
    FontAttributes="Bold"
    FontFamily="Jersey15"/>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </ScrollView>

            <CollectionView Grid.Row="2" 
                ItemsSource="{Binding Articles}"
                SelectionMode="Single"
                SelectionChanged="OnArticleSelected"
                Margin="0,20,0,0">
                <CollectionView.EmptyView>
                    <Label Text="No articles found"
               TextColor="White"
               HorizontalOptions="Center"
               VerticalOptions="Center"/>
                </CollectionView.EmptyView>
                <CollectionView.Header>
                    <BoxView HeightRequest="1" IsVisible="false"/>
                </CollectionView.Header>
                <CollectionView.Footer>
                    <BoxView HeightRequest="16" IsVisible="false"/>
                </CollectionView.Footer>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="0,0,0,16">
                            <Frame BackgroundColor="black"
                       Padding="20"
                       CornerRadius="16"
                       BorderColor="#1E293B"
                       Margin="16,0">

                                <!-- Main Content Layout -->
                                <Grid RowSpacing="16">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Author Info and Category -->
                                    <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,4">
                                        <!-- Author Avatar -->
                                        <Frame Grid.Column="0"
                                   BackgroundColor="#1E293B"
                                   HeightRequest="40"
                                   WidthRequest="40"
                                   CornerRadius="20"
                                   Padding="0"
                                   IsClippedToBounds="True"
                                   Margin="0,0,12,0">
                                            <Image Source="default_avatar.png"
                                       Aspect="AspectFill"/>
                                        </Frame>

                                        <!-- Author Details -->
                                        <StackLayout Grid.Column="1" 
                                       Spacing="2"
                                       VerticalOptions="Center">
                                            <Label Text="{Binding UserName}"
                                       TextColor="White"
                                       FontSize="14"
                                       FontAttributes="Bold"
                                       FontFamily="Jersey15"/>
                                            <Label Text="{Binding ArticleCreatedAt, StringFormat='{0:MMM dd, yyyy}'}"
                                       TextColor="#64748B"
                                       FontSize="12"
                                       FontFamily="Jersey15"/>
                                        </StackLayout>

                                        <!-- Category Tag -->
                                        <Frame Grid.Column="2"
                                   BackgroundColor="#1E293B"
                                   Padding="12,6"
                                   CornerRadius="20"
                                   HasShadow="False">
                                            <Label Text="{Binding CategoryName}"
                                       TextColor="#A5B4FC"
                                       FontSize="12"
                                       FontAttributes="Bold"
                                       FontFamily="Jersey15"/>
                                        </Frame>
                                    </Grid>

                                    <!-- Article Content -->
                                    <StackLayout Grid.Row="1" Spacing="12">
                                        <Label Text="{Binding ArticleTitle}"
                                   TextColor="White"
                                   FontSize="22"
                                   FontFamily="Jersey15"
                                   FontAttributes="Bold"
                                   LineHeight="1.4"/>

                                        <Label Text="{Binding ArticleContent}"
                                   TextColor="#CBD5E1"
                                   FontSize="15"
                                   LineHeight="1.6"
                                   MaxLines="3"
                                   LineBreakMode="TailTruncation"/>
                                    </StackLayout>

                                    <!-- Engagement Metrics -->
                                    <FlexLayout Grid.Row="2" 
                                  JustifyContent="Start"
                                  AlignItems="Center" 
                                  Wrap="NoWrap">
                                        <!-- Comments -->
                                        <Frame BackgroundColor="#1E293B"
                                   Padding="12,8"
                                   CornerRadius="20"
                                   HasShadow="False"
                                   Margin="0,0,12,0">
                                            <StackLayout Orientation="Horizontal" Spacing="8">
                                                <Image Source="comment.png"
                                           HeightRequest="18"
                                           WidthRequest="18"/>
                                                <Label Text="{Binding NumberOfComments}"
                                           TextColor="#A5B4FC"
                                           FontSize="13"
                                           FontAttributes="Bold"
                                           FontFamily="Jersey15"
                                           VerticalOptions="Center"/>
                                            </StackLayout>
                                        </Frame>

                                    
                                        <Frame BackgroundColor="#1E293B"
                                   Padding="12,8"
                                   CornerRadius="20"
                                   HasShadow="False">
                                            <StackLayout Orientation="Horizontal" Spacing="8">
                                                <Image Source="heart.png"
                                           HeightRequest="18"
                                           WidthRequest="18"/>
                                                <Label Text="{Binding NumberOfLikes}"
                                           TextColor="#A5B4FC"
                                           FontSize="13"
                                           FontAttributes="Bold"
                                           FontFamily="Jersey15"
                                           VerticalOptions="Center"/>
                                            </StackLayout>
                                        </Frame>
                                    </FlexLayout>
                                </Grid>
                            </Frame>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>



        </Grid>
    </ScrollView>
</ContentPage>
